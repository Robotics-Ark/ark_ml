name: diffusion_policy
model:
  name: DiffusionPolicyModel
  state_dim: 9
  obs_horizon: 8
  pred_horizon: 16
  action_horizon: 8
  diffusion_steps: 100
  action_dim: 8
  model_path: null
  image_encoder:
    enabled: true
    in_channels: 3
    conv_channels: [64, 128, 256, 256]
    kernel_sizes: [7, 3, 3, 3]
    strides: [2, 2, 2, 2]
    activation: silu
    norm: layernorm
    dropout: 0.0
    global_pool: true
    proj_dim: 256
  state_encoder:
    hidden_dims: [256, 256]
    output_dim: 256
    activation: gelu
    dropout: 0.0
    use_layer_norm: false
  fusion:
    type: transformer
    hidden_dim: 512
    num_layers: 4
    num_heads: 8
    dropout: 0.1
    add_time_embedding: true
  condition_head:
    hidden_dims: [512, 512]
    activation: gelu
    dropout: 0.1
    use_layer_norm: true
    output_dim: 512
  unet:
    diffusion_step_embed_dim: 256
    down_dims: [256, 512, 512]
    kernel_size: 5
    n_groups: 8
  temporal_pooling: flatten
trainer:
  max_epochs: 100
  lr: 0.0003
  weight_decay: 1e-6
  ema: true
  ema_power: 0.75
  grad_clip: 1.0
  scheduler: cosine
  batch_size: 16
  log_every_n_steps: 50
  val_every_n_epochs: 10
  num_workers: 0
